<script>
(async () => {
  // session_id aus der success_url lesen (kommt vom Checkout)
  const sid = new URLSearchParams(location.search).get('session_id');
  if (!sid) return;

  try {
    // E-Mail & Meta aus der Session holen
    const r = await fetch(`/api/checkout/session?session_id=${encodeURIComponent(sid)}`);
    if (!r.ok) throw new Error('HTTP ' + r.status);

    const { email } = await r.json();

    // E-Mail f√ºrs Dashboard merken und direkt zu Step 4 springen
    if (email) {
      localStorage.setItem('demoEmail', email);
      location.href = '/#step4';
    }
  } catch (e) {
    console.error('success.html auto-fill error:', e);
  }
})();
</script>
